Index: app/src/main/java/com/beecoder/bookstore/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.beecoder.bookstore;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.ActionBarDrawerToggle;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.appcompat.widget.Toolbar;\r\nimport androidx.core.view.GravityCompat;\r\nimport androidx.drawerlayout.widget.DrawerLayout;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.beecoder.bookstore.Authentication.AuthActivity;\r\nimport com.beecoder.bookstore.cart.CartActivity;\r\nimport com.firebase.ui.auth.AuthUI;\r\nimport com.google.android.material.navigation.NavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\n\r\npublic class MainActivity extends AppCompatActivity implements NavigationView.OnNavigationItemSelectedListener {\r\n    private FirebaseUser user;\r\n    private DrawerLayout drawerLayout;\r\n    private Toolbar toolbar;\r\n    private NavigationView navigationView;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n        user = FirebaseAuth.getInstance().getCurrentUser();\r\n\r\n        if (user == null) {\r\n            openAuthActivity();\r\n            finish();\r\n        } else {\r\n            setUserValues();\r\n            setupToolbar();\r\n            setUpNavigationDrawer(savedInstanceState);\r\n        }\r\n    }\r\n\r\n    private void setUserValues() {\r\n        CurrentUser.getUserDoc()\r\n                .get().addOnSuccessListener(snapshot -> {\r\n            if (snapshot.exists()) {\r\n                User currentUser = snapshot.toObject(User.class);\r\n                CurrentUser.getCurrentUser().setName(user.getDisplayName());\r\n                CurrentUser.getCurrentUser().setEmail(user.getEmail());\r\n                CurrentUser.getCurrentUser().setPhoneNumber(currentUser.getPhoneNumber());\r\n                CurrentUser.getCurrentUser().setPhotoUrl(currentUser.getPhotoUrl());\r\n\r\n                Toast.makeText(this, \"Asi mamah\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n    }\r\n\r\n    private void openAuthActivity() {\r\n        startActivity(new Intent(this, AuthActivity.class));\r\n    }\r\n\r\n    private void setupToolbar() {\r\n        toolbar = findViewById(R.id.toolbar);\r\n        setSupportActionBar(toolbar);\r\n    }\r\n\r\n    private void setUpNavigationDrawer(Bundle saveInstanceState) {\r\n        drawerLayout = findViewById(R.id.drawer);\r\n        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(this, drawerLayout, toolbar, R.string.openDrawerContent, R.string.closeDrawerContent);\r\n        toggle.setDrawerIndicatorEnabled(true);\r\n        drawerLayout.addDrawerListener(toggle);\r\n        navigationView = findViewById(R.id.navigation);\r\n        navigationView.setNavigationItemSelectedListener(this);\r\n        toggle.syncState();\r\n\r\n        if (saveInstanceState == null) {\r\n            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, new HomeFragment()).commit();\r\n            navigationView.setCheckedItem(R.id.home_item);\r\n        }\r\n\r\n        View headerView = navigationView.getHeaderView(0);\r\n        TextView username = headerView.findViewById(R.id.username);\r\n        TextView email = headerView.findViewById(R.id.email);\r\n        username.setText(user.getDisplayName());\r\n        email.setText(user.getEmail());\r\n    }\r\n\r\n    /* private void openSellingActivity() {\r\n         Intent intent = new Intent(this, SellingActivity.class);\r\n         startActivity(intent);\r\n     }\r\n\r\n     @Override\r\n     public boolean onPrepareOptionsMenu(Menu menu) {\r\n         getMenuInflater().inflate(R.menu.main_menu, menu);\r\n         return super.onPrepareOptionsMenu(menu);\r\n     }\r\n\r\n     @Override\r\n     public boolean onOptionsItemSelected(@NonNull MenuItem item) {\r\n         switch (item.getItemId()) {\r\n             case R.id.action_sell:\r\n                 openSellingActivity();\r\n                 break;\r\n         }\r\n         return true;\r\n     }\r\n */\r\n    @Override\r\n    public void onBackPressed() {\r\n        Fragment fragment = getSupportFragmentManager().findFragmentById(R.id.fragment_container);\r\n        if (drawerLayout.isDrawerOpen(GravityCompat.START)) {\r\n            drawerLayout.closeDrawer(GravityCompat.START);\r\n        } else if (!(fragment instanceof HomeFragment))\r\n            setFragment(new HomeFragment());\r\n        else super.onBackPressed();\r\n    }\r\n\r\n    @Override\r\n    public boolean onNavigationItemSelected(@NonNull MenuItem item) {\r\n        navigationView.setCheckedItem(item.getItemId());\r\n        switch (item.getItemId()) {\r\n            case R.id.home_item:\r\n                setFragment(new HomeFragment());\r\n                break;\r\n            case R.id.catalogue_item:\r\n                setFragment(new CatalogueFragment());\r\n                break;\r\n            case R.id.profile_item:\r\n                setFragment(new ProfileFragment(this));\r\n                break;\r\n            case R.id.logOut_item:\r\n                AuthUI.getInstance().signOut(MainActivity.this);\r\n                startActivity(new Intent(MainActivity.this, AuthActivity.class));\r\n                finish();\r\n        }\r\n        drawerLayout.closeDrawer(GravityCompat.START);\r\n        return true;\r\n    }\r\n\r\n    private void setFragment(Fragment fragment) {\r\n        getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, fragment).commit();\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/beecoder/bookstore/MainActivity.java	(revision 579e8cc8c0445ba7dcfacbaabc44271169a58f06)
+++ app/src/main/java/com/beecoder/bookstore/MainActivity.java	(date 1612801989439)
@@ -45,16 +45,16 @@
     }
 
     private void setUserValues() {
+
+        CurrentUser.getCurrentUser().setName(user.getDisplayName());
+        CurrentUser.getCurrentUser().setEmail(user.getEmail());
         CurrentUser.getUserDoc()
                 .get().addOnSuccessListener(snapshot -> {
             if (snapshot.exists()) {
                 User currentUser = snapshot.toObject(User.class);
-                CurrentUser.getCurrentUser().setName(user.getDisplayName());
-                CurrentUser.getCurrentUser().setEmail(user.getEmail());
+
                 CurrentUser.getCurrentUser().setPhoneNumber(currentUser.getPhoneNumber());
                 CurrentUser.getCurrentUser().setPhotoUrl(currentUser.getPhotoUrl());
-
-                Toast.makeText(this, "Asi mamah", Toast.LENGTH_SHORT).show();
             }
         });
     }
Index: app/src/main/java/com/beecoder/bookstore/ProfileFragment.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.beecoder.bookstore;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\n\r\nimport com.bumptech.glide.Glide;\r\n\r\nimport static android.app.Activity.RESULT_OK;\r\n\r\npublic class ProfileFragment extends Fragment {\r\n    private final int IMG_REQUEST_ID=10;\r\n\r\n    private TextView username, phoneNumber_tv,email;\r\n    private ImageView editPhone, imgBtn_photoEdit,img_userProfile;\r\n    private Button btn_uploadProfileImg;\r\n    private Uri uri;\r\n    private Context context;\r\n\r\n    @Nullable\r\n    @Override\r\n    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {\r\n        View layout = inflater.inflate(R.layout.profile_layout, container, false);\r\n        setViews(layout);\r\n        return layout;\r\n    }\r\n\r\n    ProfileFragment(Context context)\r\n    {\r\n        this.context=context;\r\n    }\r\n\r\n    private void setViews(View layout) {\r\n        email = layout.findViewById(R.id.email);\r\n        phoneNumber_tv = layout.findViewById(R.id.phone_number);\r\n        username = layout.findViewById(R.id.username);\r\n        editPhone = layout.findViewById(R.id.edit_phone_number);\r\n        img_userProfile=layout.findViewById(R.id.img_userProfile);\r\n        imgBtn_photoEdit = layout.findViewById(R.id.imgBtn_photoEdit);\r\n        btn_uploadProfileImg=layout.findViewById(R.id.btn_uploadProfileImg);\r\n        editPhone.setOnClickListener(view -> showEditPhoneDialogue());\r\n        if (CurrentUser.getCurrentUser() != null) {\r\n            email.setText(CurrentUser.getCurrentUser().getEmail());\r\n            username.setText(CurrentUser.getCurrentUser().getName());\r\n            phoneNumber_tv.setText(CurrentUser.getCurrentUser().getPhoneNumber());\r\n        }\r\n        imgBtn_photoEdit.setOnClickListener(v -> openGallery());\r\n        btn_uploadProfileImg.setOnClickListener(view -> uploadImage());\r\n        Glide.with(context)\r\n                .load(CurrentUser.getCurrentUser().getPhotoUrl())\r\n                .centerCrop()\r\n                .into(img_userProfile);\r\n\r\n    }\r\n\r\n    private void openGallery() {\r\n\r\n        Intent intent = new Intent();\r\n        intent.setType(\"image/*\");\r\n        intent.setAction(intent.ACTION_GET_CONTENT);\r\n        startActivityForResult(intent.createChooser(intent, \"Selected Image\"), IMG_REQUEST_ID);\r\n        //open gallery\r\n        //choose photo\r\n        //size komabi\r\n        //upload photo to storage and get url\r\n        // set url(User.setPhotoUrl(url))\r\n    } @Override\r\n    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n\r\n        if (requestCode == IMG_REQUEST_ID && resultCode == RESULT_OK && data != null && data.getData() != null) {\r\n            uri = data.getData();\r\n            Toast.makeText(getActivity(), \"Image Selected\", Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n    private void uploadImage()\r\n    {\r\n        CurrentUser.updatePhotoUrl(uri.toString())\r\n                .addOnCompleteListener(task -> {\r\n                    if(task.isSuccessful()) {\r\n                        Toast.makeText(getActivity(), \"Successful\", Toast.LENGTH_SHORT).show();\r\n                        Glide.with(context)\r\n                                .load(CurrentUser.getCurrentUser().getPhotoUrl())\r\n                                .centerCrop()\r\n                                .into(img_userProfile);\r\n                    }else\r\n                    {\r\n                        Toast.makeText(getActivity(), \"failed :\" + task.getResult(), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n    }\r\n\r\n\r\n\r\n    private void showEditPhoneDialogue() {\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());\r\n\r\n        EditText editText = new EditText(getActivity());\r\n        editText.setPadding(16, 16, 16, 16);\r\n        if (phoneNumber_tv.getText() != null) {\r\n            editText.setText(phoneNumber_tv.getText());\r\n        }\r\n\r\n        builder.setTitle(\"Set Phone\")\r\n                .setView(editText)\r\n                .setPositiveButton(\"Save\", (a, b) -> {\r\n                    CurrentUser.updatePhone(editText.getText().toString())\r\n                            .addOnCompleteListener(task -> {\r\n                                if (task.isSuccessful()) {\r\n                                    Toast.makeText(getActivity(), \"Successful\", Toast.LENGTH_SHORT).show();\r\n                                    phoneNumber_tv.setText(CurrentUser.getCurrentUser().getPhoneNumber());\r\n                                } else {\r\n                                    Toast.makeText(getActivity(), \"failed :\" + task.getResult(), Toast.LENGTH_SHORT).show();\r\n                                }\r\n                            });\r\n                }).setNeutralButton(\"Cancel\", null).create().show();\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/beecoder/bookstore/ProfileFragment.java	(revision 579e8cc8c0445ba7dcfacbaabc44271169a58f06)
+++ app/src/main/java/com/beecoder/bookstore/ProfileFragment.java	(date 1612846074006)
@@ -104,9 +104,6 @@
                     }
                 });
     }
-
-
-
     private void showEditPhoneDialogue() {
         AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
 
